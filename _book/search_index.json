[["index.html", "Tutorials for Tidymass shinyapp 1 Installation 1.1 Preparations 1.2 Methods to install tidymass shinyapp", " Tutorials for Tidymass shinyapp 1 Installation tidymass shinyapp (https://github.com/tidymass/tidymass_shiny) is a user-friendly web application for tidymass (https://www.tidymass.org/) that requires little or no programming experience. The app can only be installed via code now, and we will introduce how to do that step by step in this chapter. 1.1 Preparations To begin with, you need to install R and Rstudio, both of which can be free downloaded from official websites. If you have installed them before, please ensure that R version &gt; 4.1 as tidymass required, ohterwise download and install the latest version of R. Install R Download R and install it. Install Rstudio Download Rstudio and install it. Open the Rstudio Setting up the suitable Mirror You may set up the suitable mirror to accelerate R package downloads. Click “Tools” in the Rstudio, then click “Global options” and select “Packages”. You may select mirror from TUNA Team if you are users from China. 1.2 Methods to install tidymass shinyapp Here we provide three different methods to install tidymass shinyapp: R, Docker and Server. Install with R To install the app with R, you are recommended to run the following code. if (!require(&#39;remotes&#39;)) install.packages(&#39;remotes&#39;); if (!require(&#39;writexl&#39;)) install.packages(&#39;writexl&#39;); if (!require(&#39;tidyverse&#39;)) install.packages(&#39;tidyverse&#39;); if (!require(&#39;tidymass&#39;)) { source(&quot;https://www.tidymass.org/tidymass-packages/install_tidymass.txt&quot;); install_tidymass(from = &quot;tidymass.org&quot;) }; if (!require(&#39;shinyFiles&#39;)) remotes::install_github(&#39;thomasp85/shinyFiles&#39;); if (!require(&#39;shinyWidgets&#39;)) remotes::install_github(&quot;dreamRs/shinyWidgets&quot;); if (!require(&#39;shiny&#39;)) install.packages(&#39;shiny&#39;); if (!require(&#39;bsicons&#39;)) install.packages(&#39;bsicons&#39;); if (!require(&#39;bslib&#39;)) install.packages(&#39;bslib&#39;); if (!require(&#39;plotly&#39;)) install.packages(&#39;plotly&#39;); if (!require(&#39;colourpicker&#39;)) install.packages(&#39;colourpicker&#39;); if (!require(&#39;plantmdb&#39;)) remotes::install_github(&quot;xuebinzhang-lab/plantmdb&quot;) ## plant metabolomics database. for test use. if (!require(&#39;tidymassshiny&#39;)) remotes::install_github(&#39;tidymass/tidymass_shiny&#39;) To start the app, run the code. library(tidyverse) library(tidymass) library(tidymassshiny) library(plantmdb) ## for test use run_tidymass_shiny() You should be able to see: To update the app to the newest version, you can run the code. remotes::install_github(&#39;tidymass/tidymass_shiny&#39;) Install with Docker Install with Server "],["upstream-data-processing.html", "2 Upstream data processing 2.1 Data format converter 2.2 Methods to upload the files 2.3 Project initiate 2.4 Data import 2.5 Data quaily assessment 2.6 Data cleaning", " 2 Upstream data processing To perform multiple analysis with Tidymass shinyapp, you need to upload files first, the demo data can be downloaded through Google Drive or BaiduNetdisk. 2.1 Data format converter If your data is in raw format, you may first convert it to .mzML or .mzXML format using ProteoWizard. Please note that ProteoWizard only support Windows OS, you may consider massconverter if you don’t use Windows OS. You can refer to the following parameter settings for ProteoWizard. 2.2 Methods to upload the files To begin with, you need to set up the working directory and upload the required files. Here we provide three options to do that. Start with Ms file: If you have raw data in the format like .mzML or mzXML. You can click on ‘Start with Ms file’ to upload the file. Start with table file: If your data is a post-peak metabolite expression matrix, you can click on the ‘Start with table file’ button to upload the data. The sample table is as follows, and the first four columns must exist, with column names not to be changed. Start with massdataset object: If your data is generated by Tidymass, you can choose the ‘Start with massdataset object’ button and directly upload them. 2.3 Project initiate Here are the steps you need to follow to initiate the project: Set working directory Upload sample_info.csv file You may click the dropdown button and adjust the column names if there are any changes for them. Click “Initialize Project” button and check the sample information. 2.4 Data import Upload Ms file Before importing the data, please make sure the files are properly organized according to sample type, such as QC and Subject. Here is an example: Click the dropdown button Data import and select Start with MS file. Then click SELECT MS1 FOLDER and choose the MS1 folder. Next, click CHECK INPUT FILE and a prompt will appear if the files have been successfully uploaded. After the files are ready for analysis, you can choose to set peak picking parameters yourself. Here are some important parameters: ppm: Peak detection ppm. peakwidth: Peak width. It is dependent on your column and LC system. snthresh: Signal to noise threshold. noise: Noise cutoff. threads: The core number for performing. For more details, please refer to massprocesser. If you want to use the recommended parameters, just click Start to proceed with further optimization. This will find the best ppm cutoff and run with it to perform the optimization. Finally, click Start peak picking and get the results. Upload table file Click the dropdown button Data import and select Start with table file. Then click BROWSE and select the csv table. Next, click INPUT FILE SUMMARY and you will see a summary of input file. If all the check have passed, then click GENERATE MASSDATASET OBJECT to obtain massdataset objects for both positive and negative modes. Upload mass_dataset file If you already have massdataset objects generated by Tidymass, you can simply upload them in this way. Upload objects for positive and negative modes and click CKECK INPUT 2.5 Data quaily assessment To have an overall understanding and assessment about the data, you can select Overview and click START to generate multiple plots, including peak distribution, missing value summary and missing value in samples etc. Here you can also adjust parameters and download these plots according to your requirement. 2.6 Data cleaning Before metabolite annotation, it’s necessary to perform data cleaning. Remove noisy metabolic features The first step is removing noisy metabolic features. Here we choose to remove variables which have MVs in more than 20% QC samples and in at lest 50% samples in control group or case group, so the MV cutoff of QC samples (%) has been set as 20 and MV cutoff (%) has been set as 50. Click START to remove these noisy metabolites. Next, you can visualize the MV percentage of samples for QC group, Subject group or both of them by click SHOW PLOT. Filter outlier samples When analyzing large cohorts, outlier samples can be a serious problem. In this step, we will filter these outlier samples. Before filtering outlier samples, you can click START above to show the plot for Missing value in samples and PCA plot. In Tidymass shinyapp, we provide multiple options to filter outliers, you may select different strategies according to your requirement. For more information, you may refer to this blog. For “By tidymass” strategy, four remove outlier conditions are provided: according to NA (according_to_na), accoriding to standard deviation for principal component (pc_sd), according to mean abosolute deviation for principal component (pc_mad) and according to distance (according_to_distance). For “By myself” strategy, the ourliers for both positive and negative modes are set to be “none”. Click START below to filter outlier samples. Missing value imputation Here you can select many different methods for missing value imputation, including knn, missforest (mf) and ppca etc. Parameters For knn k: the parameters can be modified include number of neighbors. Defaults to 10. rowmax: maximum row missing proportion. Defaults to 0.5. colmax: maximum column missing proportion. Defaults to 0.8. maxp: maximum prediction proportion. Defaults to 1500. rng.seed: random number generator seed. For missForest (rf) maxiter: the parameters include maximum iterations. Defaults to 10. ntree: number of trees. Defaults to 100. decreasing: whether to interpolate missing values in order from most to least number of missing values. Defaults to FALSE. For ppca nPcs: the parameters can be modified include number of principal components. Defaults to 2. maxSteps: maximum steps for iterations. Defaults to 100. threshold: convergence threshold. Defaults to 1e-04. If the method has been chosen and all the parameters have been set, click START to perform missing value imputation. Data normalization and integration To remove unwanted analytical variations and integrate multiple batches forming an integral data set for subsequent statistical analysis, we need to perform data normalization and integration. Here we provide several methods to be selected, including QC sample-based data normalization like SVR and loess and sample-wise method like PQN, median, mean and total intensity normalization. Parameters keep_scale: whether to keep the original scale of the data during the data standardization process. Defaults to TRUE. optimization: whether to enable optimization steps in the standardization process. Defaults to TRUE. pqn_reference: the reference value selected for using the Probabilistic Quotient Normalization method. Defaults to median. begin_value: the start value for parameter search range. Defaults to 0.5. end_value: the end value for parameter search range. Defaults to 1. step_value: the increment at each step of the parameter search. Defaults to 0.2. multiple: the standardized factors used to control multiples. Defaults to 1. threads: the number of threads for normalization. Defaults to 1. Click START to perform the normalization and integration. Then click SHOW PLOT to visualize the difference before and after the normalization. "],["downstream-data-processing.html", "3 Downstream data processing 3.1 Metabolite annotation 3.2 Annotation filtering 3.3 Origin analysis (to be done)", " 3 Downstream data processing 3.1 Metabolite annotation Metabolite annotation can be performed based on in-house and available open-source databases. To begin with, you need to click SELECT MS2 FOLDER and import prepared MS2 data. These files should be in the format of “.mgf”, and they should be stored separately for negative and positive modes. Parameters column: A character vector specifying the column types. Default is “rp”. ms1.ms2.match.mz.tol: Numeric, the m/z tolerance for matching MS1 and MS2. Default is 15. ms1.ms2.match.rt.tol: Numeric, the retention time tolerance for matching MS1 and MS2. Default is 30. Once you have set the parameters, click START to import MS2 data. Next, you can choose suitable parameters for metabolite annotation. Parameters ms1.match.ppm: A numeric value specifying the mass accuracy threshold for MS1 matching in parts per million (ppm). Defaults to 25. ms2.match.ppm: A numeric value specifying the mass accuracy threshold for MS2 (Fragment ion) matching in ppm. Defaults to 30. rt.match.tol: A numeric value specifying the retention time matching tolerance in seconds. Defaults to 30. candidate.num: A numeric value specifying the number of top candidates to retain per feature. Defaults to 3. column: A character string specifying the chromatographic column type, either “rp” (reverse phase) or “hilic”. Defaults to “rp”. threads: An integer specifying the number of threads to use for parallel processing. Defaults to 3. We also need necessary MS2 databases for metabolite annotation, you may download these databases from metid website. You can also use Tidymass to build your own database, but please be noted that the format should be in “.rda”. After the download is complete, place them in a new folder and click CHOOSE FOLDER. Here we also provide some public databases and you can simply select them to perform annotation without downloading anything. 3.2 Annotation filtering The annotation results are assigned conﬁdence levels according to MSI (in-house database, level 1; public MS 2database, level 2; MS1 database, level 3). After obtaining annotation results, you can choose how to keep multiple annotations, how to remove redundancy and how to keep annotation levels. Click Adduct for level 3 annotation and select suitable models and methods, then click START to perform annotation filtering. 3.3 Origin analysis (to be done) "],["references.html", "4 References", " 4 References Shen, X., Yan, H., Wang, C. et al. TidyMass an object-oriented reproducible analysis framework for LC–MS data. Nat Commun 13, 4365 (2022). https://doi.org/10.1038/s41467-022-32155-w https://www.tidymass.org/ https://github.com/tidymass/tidymass_shiny "]]
